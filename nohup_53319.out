job dir: /Users/dpeleg/PycharmProjects/mae
Splits by patients:
83 21 27
Train Shape:  (11397, 256, 256, 1) Validation Shape:  (3352, 256, 256, 1) Test Shape:  (4414, 256, 256, 1)
Train Processed 0/11397
Train Processed 500/11397
Train Processed 1000/11397
Train Processed 1500/11397
Train Processed 2000/11397
Train Processed 2500/11397
Train Processed 3000/11397
Train Processed 3500/11397
Train Processed 4000/11397
Train Processed 4500/11397
Train Processed 5000/11397
Train Processed 5500/11397
Train Processed 6000/11397
Train Processed 6500/11397
Train Processed 7000/11397
Train Processed 7500/11397
Train Processed 8000/11397
Train Processed 8500/11397
Train Processed 9000/11397
Train Processed 9500/11397
Train Processed 10000/11397
Train Processed 10500/11397
Train Processed 11000/11397
Completed Train Processed 11397/11397
Val Processed 0/3352
Val Processed 500/3352
Val Processed 1000/3352
Val Processed 1500/3352
Val Processed 2000/3352
Val Processed 2500/3352
Val Processed 3000/3352
Completed Val Processed 3352/3352
Test Processed 0/4414
Test Processed 500/4414
Test Processed 1000/4414
Test Processed 1500/4414
Test Processed 2000/4414
Test Processed 2500/4414
Test Processed 3000/4414
Test Processed 3500/4414
Test Processed 4000/4414
Completed Test Processed 4414/4414
###### Summary of the dataset
Number of patients:  131
Train X shape: (11397, 256, 256, 1) Train Masked: (11397, 256, 256)
Train Y shape: (11397, 256, 256, 1)
Val X shape: (3352, 256, 256, 1) Val X Masked: (3352, 256, 256)
Val Y shape: (3352, 256, 256, 1)
Test X shape: (4414, 256, 256, 1) Test X Masked: (4414, 256, 256)
Test Y shape: (4414, 256, 256, 1)
###### End Summary ##########
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 256, 256,  │          0 │ -                 │
│ (InputLayer)        │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 256, 256,  │        320 │ input_layer[0][0] │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 128, 128,  │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 128, 128,  │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 64, 64,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 64, 64,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 64, 64,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 128, 128,  │          0 │ conv2d_5[0][0]    │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 128, 128,  │          0 │ up_sampling2d[0]… │
│ (Concatenate)       │ 192)              │            │ conv2d_3[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 128, 128,  │    110,656 │ concatenate[0][0] │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_6[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 256, 256,  │          0 │ conv2d_7[0][0]    │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 256, 256,  │          0 │ up_sampling2d_1[… │
│ (Concatenate)       │ 96)               │            │ conv2d_1[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 256, 256,  │     27,680 │ concatenate_1[0]… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d_8[0][0]    │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 256, 256,  │         33 │ conv2d_9[0][0]    │
│                     │ 1)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 470,977 (1.80 MB)
 Trainable params: 470,977 (1.80 MB)
 Non-trainable params: 0 (0.00 B)
Epoch 1/3
90/90 - 1211s - 13s/step - dice_coef: 0.5455 - iou_metric: 0.3805 - loss: 0.8684 - val_dice_coef: 0.6084 - val_iou_metric: 0.4396 - val_loss: 0.7134
Epoch 2/3
90/90 - 1250s - 14s/step - dice_coef: 0.6349 - iou_metric: 0.4652 - loss: 0.6922 - val_dice_coef: 0.6246 - val_iou_metric: 0.4563 - val_loss: 0.7076
Epoch 3/3
90/90 - 1272s - 14s/step - dice_coef: 0.6450 - iou_metric: 0.4761 - loss: 0.6708 - val_dice_coef: 0.6300 - val_iou_metric: 0.4623 - val_loss: 0.6661
[1m  1/105[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1:13[0m 705ms/step - dice_coef: 0.5726 - iou_metric: 0.4012 - loss: 0.7295[1m  2/105[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1:36[0m 936ms/step - dice_coef: 0.5819 - iou_metric: 0.4105 - loss: 0.7092[1m  3/105[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1:33[0m 920ms/step - dice_coef: 0.5941 - iou_metric: 0.4234 - loss: 0.6875[1m  4/105[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1:32[0m 912ms/step - dice_coef: 0.6074 - iou_metric: 0.4380 - loss: 0.6683[1m  5/105[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1:31[0m 910ms/step - dice_coef: 0.6150 - iou_metric: 0.4461 - loss: 0.6562[1m  6/105[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1:30[0m 910ms/step - dice_coef: 0.6157 - iou_metric: 0.4472 - loss: 0.6528[1m  7/105[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1:29[0m 909ms/step - dice_coef: 0.6145 - iou_metric: 0.4463 - loss: 0.6528[1m  8/105[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1:28[0m 910ms/step - dice_coef: 0.6136 - iou_metric: 0.4455 - loss: 0.6534[1m  9/105[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1:27[0m 908ms/step - dice_coef: 0.6137 - iou_metric: 0.4457 - loss: 0.6536[1m 10/105[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1:26[0m 907ms/step - dice_coef: 0.6143 - iou_metric: 0.4464 - loss: 0.6535[1m 11/105[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m1:25[0m 905ms/step - dice_coef: 0.6149 - iou_metric: 0.4470 - loss: 0.6535[1m 12/105[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m1:24[0m 905ms/step - dice_coef: 0.6153 - iou_metric: 0.4474 - loss: 0.6538[1m 13/105[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m1:23[0m 905ms/step - dice_coef: 0.6158 - iou_metric: 0.4480 - loss: 0.6542[1m 14/105[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m1:22[0m 905ms/step - dice_coef: 0.6169 - iou_metric: 0.4491 - loss: 0.6540[1m 15/105[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m1:21[0m 905ms/step - dice_coef: 0.6184 - iou_metric: 0.4508 - loss: 0.6532[1m 16/105[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1:20[0m 905ms/step - dice_coef: 0.6202 - iou_metric: 0.4528 - loss: 0.6522[1m 17/105[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1:19[0m 906ms/step - dice_coef: 0.6215 - iou_metric: 0.4543 - loss: 0.6515[1m 18/105[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1:18[0m 906ms/step - dice_coef: 0.6222 - iou_metric: 0.4551 - loss: 0.6515[1m 19/105[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1:17[0m 906ms/step - dice_coef: 0.6224 - iou_metric: 0.4554 - loss: 0.6521[1m 20/105[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1:17[0m 906ms/step - dice_coef: 0.6224 - iou_metric: 0.4555 - loss: 0.6530[1m 21/105[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1:16[0m 906ms/step - dice_coef: 0.6224 - iou_metric: 0.4556 - loss: 0.6540[1m 22/105[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1:15[0m 905ms/step - dice_coef: 0.6224 - iou_metric: 0.4556 - loss: 0.6550[1m 23/105[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1:14[0m 905ms/step - dice_coef: 0.6224 - iou_metric: 0.4557 - loss: 0.6559[1m 24/105[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1:13[0m 906ms/step - dice_coef: 0.6224 - iou_metric: 0.4557 - loss: 0.6568[1m 25/105[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1:12[0m 906ms/step - dice_coef: 0.6223 - iou_metric: 0.4556 - loss: 0.6577[1m 26/105[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1:11[0m 907ms/step - dice_coef: 0.6221 - iou_metric: 0.4555 - loss: 0.6588[1m 27/105[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m1:10[0m 907ms/step - dice_coef: 0.6219 - iou_metric: 0.4553 - loss: 0.6600[1m 28/105[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m1:09[0m 906ms/step - dice_coef: 0.6218 - iou_metric: 0.4551 - loss: 0.6611[1m 29/105[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m1:08[0m 906ms/step - dice_coef: 0.6217 - iou_metric: 0.4551 - loss: 0.6622[1m 30/105[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m1:08[0m 908ms/step - dice_coef: 0.6217 - iou_metric: 0.4551 - loss: 0.6633[1m 31/105[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m1:07[0m 908ms/step - dice_coef: 0.6218 - iou_metric: 0.4551 - loss: 0.6643[1m 32/105[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m1:06[0m 908ms/step - dice_coef: 0.6218 - iou_metric: 0.4552 - loss: 0.6652[1m 33/105[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m1:05[0m 908ms/step - dice_coef: 0.6219 - iou_metric: 0.4552 - loss: 0.6661[1m 34/105[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m1:04[0m 908ms/step - dice_coef: 0.6218 - iou_metric: 0.4552 - loss: 0.6670[1m 35/105[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m1:03[0m 907ms/step - dice_coef: 0.6218 - iou_metric: 0.4551 - loss: 0.6678[1m 36/105[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m1:02[0m 907ms/step - dice_coef: 0.6218 - iou_metric: 0.4551 - loss: 0.6686[1m 37/105[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m1:01[0m 907ms/step - dice_coef: 0.6218 - iou_metric: 0.4551 - loss: 0.6693[1m 38/105[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m1:00[0m 907ms/step - dice_coef: 0.6217 - iou_metric: 0.4550 - loss: 0.6699[1m 39/105[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m59s[0m 907ms/step - dice_coef: 0.6216 - iou_metric: 0.4549 - loss: 0.6706 [1m 40/105[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m58s[0m 907ms/step - dice_coef: 0.6215 - iou_metric: 0.4547 - loss: 0.6713[1m 41/105[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m57s[0m 906ms/step - dice_coef: 0.6214 - iou_metric: 0.4546 - loss: 0.6719[1m 42/105[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m57s[0m 906ms/step - dice_coef: 0.6213 - iou_metric: 0.4545 - loss: 0.6724[1m 43/105[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m56s[0m 906ms/step - dice_coef: 0.6213 - iou_metric: 0.4545 - loss: 0.6729[1m 44/105[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m55s[0m 906ms/step - dice_coef: 0.6212 - iou_metric: 0.4544 - loss: 0.6734[1m 45/105[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m54s[0m 906ms/step - dice_coef: 0.6212 - iou_metric: 0.4544 - loss: 0.6739[1m 46/105[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m53s[0m 906ms/step - dice_coef: 0.6212 - iou_metric: 0.4544 - loss: 0.6744[1m 47/105[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m52s[0m 906ms/step - dice_coef: 0.6212 - iou_metric: 0.4544 - loss: 0.6750[1m 48/105[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m51s[0m 907ms/step - dice_coef: 0.6212 - iou_metric: 0.4544 - loss: 0.6755[1m 49/105[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m50s[0m 907ms/step - dice_coef: 0.6212 - iou_metric: 0.4544 - loss: 0.6760[1m 50/105[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m49s[0m 906ms/step - dice_coef: 0.6213 - iou_metric: 0.4544 - loss: 0.6764[1m 51/105[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m48s[0m 906ms/step - dice_coef: 0.6213 - iou_metric: 0.4544 - loss: 0.6768[1m 52/105[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m48s[0m 906ms/step - dice_coef: 0.6214 - iou_metric: 0.4545 - loss: 0.6772[1m 53/105[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m47s[0m 906ms/step - dice_coef: 0.6214 - iou_metric: 0.4546 - loss: 0.6775[1m 54/105[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m46s[0m 907ms/step - dice_coef: 0.6215 - iou_metric: 0.4546 - loss: 0.6777[1m 55/105[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m45s[0m 907ms/step - dice_coef: 0.6216 - iou_metric: 0.4547 - loss: 0.6779[1m 56/105[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m44s[0m 907ms/step - dice_coef: 0.6217 - iou_metric: 0.4547 - loss: 0.6781[1m 57/105[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m43s[0m 907ms/step - dice_coef: 0.6217 - iou_metric: 0.4548 - loss: 0.6783[1m 58/105[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m42s[0m 907ms/step - dice_coef: 0.6218 - iou_metric: 0.4549 - loss: 0.6783[1m 59/105[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m41s[0m 907ms/step - dice_coef: 0.6220 - iou_metric: 0.4550 - loss: 0.6784[1m 60/105[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m40s[0m 907ms/step - dice_coef: 0.6221 - iou_metric: 0.4552 - loss: 0.6783[1m 61/105[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m39s[0m 906ms/step - dice_coef: 0.6223 - iou_metric: 0.4553 - loss: 0.6783[1m 62/105[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m38s[0m 906ms/step - dice_coef: 0.6224 - iou_metric: 0.4554 - loss: 0.6783[1m 63/105[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m38s[0m 906ms/step - dice_coef: 0.6225 - iou_metric: 0.4555 - loss: 0.6782[1m 64/105[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m37s[0m 906ms/step - dice_coef: 0.6226 - iou_metric: 0.4556 - loss: 0.6782[1m 65/105[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m36s[0m 905ms/step - dice_coef: 0.6227 - iou_metric: 0.4557 - loss: 0.6781[1m 66/105[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m35s[0m 905ms/step - dice_coef: 0.6228 - iou_metric: 0.4559 - loss: 0.6780[1m 67/105[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m34s[0m 905ms/step - dice_coef: 0.6230 - iou_metric: 0.4560 - loss: 0.6778[1m 68/105[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m33s[0m 905ms/step - dice_coef: 0.6231 - iou_metric: 0.4561 - loss: 0.6777[1m 69/105[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m32s[0m 905ms/step - dice_coef: 0.6232 - iou_metric: 0.4562 - loss: 0.6776[1m 70/105[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m31s[0m 904ms/step - dice_coef: 0.6233 - iou_metric: 0.4563 - loss: 0.6775[1m 71/105[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m30s[0m 904ms/step - dice_coef: 0.6234 - iou_metric: 0.4564 - loss: 0.6774[1m 72/105[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m29s[0m 904ms/step - dice_coef: 0.6234 - iou_metric: 0.4565 - loss: 0.6774[1m 73/105[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m28s[0m 904ms/step - dice_coef: 0.6235 - iou_metric: 0.4565 - loss: 0.6773[1m 74/105[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m28s[0m 904ms/step - dice_coef: 0.6235 - iou_metric: 0.4565 - loss: 0.6773[1m 75/105[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m27s[0m 904ms/step - dice_coef: 0.6235 - iou_metric: 0.4566 - loss: 0.6772[1m 76/105[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m26s[0m 903ms/step - dice_coef: 0.6236 - iou_metric: 0.4566 - loss: 0.6772[1m 77/105[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m25s[0m 903ms/step - dice_coef: 0.6236 - iou_metric: 0.4566 - loss: 0.6772[1m 78/105[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m24s[0m 903ms/step - dice_coef: 0.6236 - iou_metric: 0.4567 - loss: 0.6771[1m 79/105[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m23s[0m 903ms/step - dice_coef: 0.6237 - iou_metric: 0.4567 - loss: 0.6771[1m 80/105[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m22s[0m 903ms/step - dice_coef: 0.6237 - iou_metric: 0.4567 - loss: 0.6770[1m 81/105[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m21s[0m 903ms/step - dice_coef: 0.6237 - iou_metric: 0.4567 - loss: 0.6769[1m 82/105[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m20s[0m 903ms/step - dice_coef: 0.6237 - iou_metric: 0.4567 - loss: 0.6769[1m 83/105[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m19s[0m 903ms/step - dice_coef: 0.6237 - iou_metric: 0.4567 - loss: 0.6768[1m 84/105[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m18s[0m 903ms/step - dice_coef: 0.6237 - iou_metric: 0.4566 - loss: 0.6768[1m 85/105[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m18s[0m 904ms/step - dice_coef: 0.6236 - iou_metric: 0.4566 - loss: 0.6768[1m 86/105[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m17s[0m 904ms/step - dice_coef: 0.6236 - iou_metric: 0.4566 - loss: 0.6767[1m 87/105[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m16s[0m 903ms/step - dice_coef: 0.6236 - iou_metric: 0.4566 - loss: 0.6766[1m 88/105[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m15s[0m 903ms/step - dice_coef: 0.6237 - iou_metric: 0.4566 - loss: 0.6765[1m 89/105[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m14s[0m 903ms/step - dice_coef: 0.6237 - iou_metric: 0.4566 - loss: 0.6764[1m 90/105[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m13s[0m 903ms/step - dice_coef: 0.6237 - iou_metric: 0.4567 - loss: 0.6763[1m 91/105[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m12s[0m 903ms/step - dice_coef: 0.6237 - iou_metric: 0.4567 - loss: 0.6762[1m 92/105[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m11s[0m 903ms/step - dice_coef: 0.6238 - iou_metric: 0.4568 - loss: 0.6761[1m 93/105[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m10s[0m 903ms/step - dice_coef: 0.6239 - iou_metric: 0.4569 - loss: 0.6759[1m 94/105[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m9s[0m 903ms/step - dice_coef: 0.6239 - iou_metric: 0.4569 - loss: 0.6758 [1m 95/105[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m9s[0m 903ms/step - dice_coef: 0.6240 - iou_metric: 0.4570 - loss: 0.6756[1m 96/105[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m8s[0m 903ms/step - dice_coef: 0.6240 - iou_metric: 0.4570 - loss: 0.6755[1m 97/105[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m7s[0m 903ms/step - dice_coef: 0.6240 - iou_metric: 0.4570 - loss: 0.6754[1m 98/105[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m6s[0m 903ms/step - dice_coef: 0.6241 - iou_metric: 0.4571 - loss: 0.6753[1m 99/105[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m5s[0m 903ms/step - dice_coef: 0.6241 - iou_metric: 0.4571 - loss: 0.6753[1m100/105[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m4s[0m 903ms/step - dice_coef: 0.6241 - iou_metric: 0.4571 - loss: 0.6752[1m101/105[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m3s[0m 903ms/step - dice_coef: 0.6242 - iou_metric: 0.4572 - loss: 0.6751[1m102/105[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m2s[0m 902ms/step - dice_coef: 0.6242 - iou_metric: 0.4572 - loss: 0.6751[1m103/105[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m1s[0m 902ms/step - dice_coef: 0.6242 - iou_metric: 0.4573 - loss: 0.6750[1m104/105[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 902ms/step - dice_coef: 0.6243 - iou_metric: 0.4573 - loss: 0.6750[1m105/105[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 900ms/step - dice_coef: 0.6243 - iou_metric: 0.4573 - loss: 0.6749[1m105/105[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m94s[0m 900ms/step - dice_coef: 0.6243 - iou_metric: 0.4574 - loss: 0.6749
Validation Dice and IoU: [0.6701269149780273, 0.6272000074386597, 0.4603496491909027]
Model saved to UNet_Model/saved_models/unet_ssl_ct_liver_131.keras
Training history saved to UNet_Model/saved_models/unet_ssl_ct_history_131.json
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 256, 256,  │          0 │ -                 │
│ (InputLayer)        │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 256, 256,  │        320 │ input_layer[0][0] │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 128, 128,  │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 128, 128,  │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 64, 64,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 64, 64,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 64, 64,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 128, 128,  │          0 │ conv2d_5[0][0]    │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 128, 128,  │          0 │ up_sampling2d[0]… │
│ (Concatenate)       │ 192)              │            │ conv2d_3[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 128, 128,  │    110,656 │ concatenate[0][0] │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_6[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 256, 256,  │          0 │ conv2d_7[0][0]    │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 256, 256,  │          0 │ up_sampling2d_1[… │
│ (Concatenate)       │ 96)               │            │ conv2d_1[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 256, 256,  │     27,680 │ concatenate_1[0]… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d_8[0][0]    │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 256, 256,  │         33 │ conv2d_9[0][0]    │
│                     │ 1)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 1,412,933 (5.39 MB)
 Trainable params: 470,977 (1.80 MB)
 Non-trainable params: 0 (0.00 B)
 Optimizer params: 941,956 (3.59 MB)
total patients for testing: 27

Mean Dice score per slice: 0.6739
Mean IoU  score per slice: 0.5125
Mean Dice score per patient: 0.6770
Mean IoU  score per patient: 0.5161
     6030.47 real     42517.73 user      5412.53 sys
job dir: /Users/dpeleg/PycharmProjects/mae
Splits by patients:
83 21 27
Train Shape:  (11397, 256, 256, 1) Validation Shape:  (3352, 256, 256, 1) Test Shape:  (4414, 256, 256, 1)
Train Processed 0/11397
Train Processed 500/11397
Train Processed 1000/11397
Train Processed 1500/11397
Train Processed 2000/11397
Train Processed 2500/11397
Train Processed 3000/11397
Train Processed 3500/11397
Train Processed 4000/11397
Train Processed 4500/11397
Train Processed 5000/11397
Train Processed 5500/11397
Train Processed 6000/11397
Train Processed 6500/11397
Train Processed 7000/11397
Train Processed 7500/11397
Train Processed 8000/11397
Train Processed 8500/11397
Train Processed 9000/11397
Train Processed 9500/11397
Train Processed 10000/11397
Train Processed 10500/11397
Train Processed 11000/11397
Completed Train Processed 11397/11397
Val Processed 0/3352
Val Processed 500/3352
Val Processed 1000/3352
Val Processed 1500/3352
Val Processed 2000/3352
Val Processed 2500/3352
Val Processed 3000/3352
Completed Val Processed 3352/3352
Test Processed 0/4414
Test Processed 500/4414
Test Processed 1000/4414
Test Processed 1500/4414
Test Processed 2000/4414
Test Processed 2500/4414
Test Processed 3000/4414
Test Processed 3500/4414
Test Processed 4000/4414
Completed Test Processed 4414/4414
###### Summary of the dataset
Number of patients:  131
Train X shape: (11397, 256, 256, 1) Train Masked: (11397, 256, 256)
Train Y shape: (11397, 256, 256, 1)
Val X shape: (3352, 256, 256, 1) Val X Masked: (3352, 256, 256)
Val Y shape: (3352, 256, 256, 1)
Test X shape: (4414, 256, 256, 1) Test X Masked: (4414, 256, 256)
Test Y shape: (4414, 256, 256, 1)
###### End Summary ##########
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 256, 256,  │          0 │ -                 │
│ (InputLayer)        │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 256, 256,  │        320 │ input_layer[0][0] │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 128, 128,  │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 128, 128,  │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 64, 64,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 64, 64,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 64, 64,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 128, 128,  │          0 │ conv2d_5[0][0]    │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 128, 128,  │          0 │ up_sampling2d[0]… │
│ (Concatenate)       │ 192)              │            │ conv2d_3[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 128, 128,  │    110,656 │ concatenate[0][0] │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_6[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 256, 256,  │          0 │ conv2d_7[0][0]    │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 256, 256,  │          0 │ up_sampling2d_1[… │
│ (Concatenate)       │ 96)               │            │ conv2d_1[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 256, 256,  │     27,680 │ concatenate_1[0]… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d_8[0][0]    │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 256, 256,  │         33 │ conv2d_9[0][0]    │
│                     │ 1)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 470,977 (1.80 MB)
 Trainable params: 470,977 (1.80 MB)
 Non-trainable params: 0 (0.00 B)
Epoch 1/100
90/90 - 1175s - 13s/step - dice_coef: 0.5449 - iou_metric: 0.3797 - loss: 0.8685 - val_dice_coef: 0.5888 - val_iou_metric: 0.4196 - val_loss: 0.7210
Epoch 2/100
90/90 - 1223s - 14s/step - dice_coef: 0.6340 - iou_metric: 0.4643 - loss: 0.6938 - val_dice_coef: 0.6113 - val_iou_metric: 0.4426 - val_loss: 0.6850
Epoch 3/100
90/90 - 1260s - 14s/step - dice_coef: 0.6457 - iou_metric: 0.4768 - loss: 0.6682 - val_dice_coef: 0.6430 - val_iou_metric: 0.4764 - val_loss: 0.6609
Epoch 4/100
90/90 - 1368s - 15s/step - dice_coef: 0.6499 - iou_metric: 0.4814 - loss: 0.6601 - val_dice_coef: 0.6424 - val_iou_metric: 0.4757 - val_loss: 0.6515
Epoch 5/100
90/90 - 1297s - 14s/step - dice_coef: 0.6569 - iou_metric: 0.4891 - loss: 0.6443 - val_dice_coef: 0.6553 - val_iou_metric: 0.4898 - val_loss: 0.6432
Epoch 6/100
90/90 - 1313s - 15s/step - dice_coef: 0.6610 - iou_metric: 0.4937 - loss: 0.6350 - val_dice_coef: 0.6537 - val_iou_metric: 0.4880 - val_loss: 0.6408
Epoch 7/100
90/90 - 1310s - 15s/step - dice_coef: 0.6628 - iou_metric: 0.4957 - loss: 0.6333 - val_dice_coef: 0.6231 - val_iou_metric: 0.4549 - val_loss: 0.6801
Epoch 8/100
90/90 - 1301s - 14s/step - dice_coef: 0.6632 - iou_metric: 0.4962 - loss: 0.6319 - val_dice_coef: 0.6526 - val_iou_metric: 0.4868 - val_loss: 0.6313
Epoch 9/100
90/90 - 1350s - 15s/step - dice_coef: 0.6688 - iou_metric: 0.5025 - loss: 0.6207 - val_dice_coef: 0.6403 - val_iou_metric: 0.4735 - val_loss: 0.6365
Epoch 10/100
90/90 - 1339s - 15s/step - dice_coef: 0.6709 - iou_metric: 0.5048 - loss: 0.6162 - val_dice_coef: 0.6616 - val_iou_metric: 0.4968 - val_loss: 0.6182
Epoch 11/100
90/90 - 1339s - 15s/step - dice_coef: 0.6723 - iou_metric: 0.5064 - loss: 0.6121 - val_dice_coef: 0.6568 - val_iou_metric: 0.4915 - val_loss: 0.6329
Epoch 12/100
90/90 - 1301s - 14s/step - dice_coef: 0.6688 - iou_metric: 0.5026 - loss: 0.6232 - val_dice_coef: 0.6428 - val_iou_metric: 0.4760 - val_loss: 0.6430
Epoch 13/100
90/90 - 1290s - 14s/step - dice_coef: 0.6711 - iou_metric: 0.5051 - loss: 0.6163 - val_dice_coef: 0.6642 - val_iou_metric: 0.4997 - val_loss: 0.6405
Epoch 14/100
90/90 - 1292s - 14s/step - dice_coef: 0.6753 - iou_metric: 0.5098 - loss: 0.6079 - val_dice_coef: 0.6570 - val_iou_metric: 0.4917 - val_loss: 0.6142
Epoch 15/100
90/90 - 1277s - 14s/step - dice_coef: 0.6769 - iou_metric: 0.5116 - loss: 0.6041 - val_dice_coef: 0.6351 - val_iou_metric: 0.4678 - val_loss: 0.6834
Epoch 16/100
90/90 - 1300s - 14s/step - dice_coef: 0.6676 - iou_metric: 0.5012 - loss: 0.6256 - val_dice_coef: 0.6597 - val_iou_metric: 0.4948 - val_loss: 0.6140
Epoch 17/100
90/90 - 1357s - 15s/step - dice_coef: 0.6759 - iou_metric: 0.5105 - loss: 0.6045 - val_dice_coef: 0.6725 - val_iou_metric: 0.5091 - val_loss: 0.6139
Epoch 18/100
90/90 - 1398s - 16s/step - dice_coef: 0.6783 - iou_metric: 0.5133 - loss: 0.6018 - val_dice_coef: 0.6642 - val_iou_metric: 0.4998 - val_loss: 0.6206
Epoch 19/100
90/90 - 1397s - 16s/step - dice_coef: 0.6786 - iou_metric: 0.5136 - loss: 0.5999 - val_dice_coef: 0.6635 - val_iou_metric: 0.4991 - val_loss: 0.6136
Epoch 20/100
90/90 - 2678s - 30s/step - dice_coef: 0.6795 - iou_metric: 0.5147 - loss: 0.5982 - val_dice_coef: 0.6613 - val_iou_metric: 0.4966 - val_loss: 0.6075
Epoch 21/100
90/90 - 1180s - 13s/step - dice_coef: 0.6131 - iou_metric: 0.4484 - loss: 0.7601 - val_dice_coef: 0.5950 - val_iou_metric: 0.4260 - val_loss: 0.7323
Epoch 22/100
90/90 - 1223s - 14s/step - dice_coef: 0.6392 - iou_metric: 0.4698 - loss: 0.6808 - val_dice_coef: 0.6350 - val_iou_metric: 0.4678 - val_loss: 0.6683
Epoch 23/100
90/90 - 1212s - 13s/step - dice_coef: 0.6505 - iou_metric: 0.4821 - loss: 0.6552 - val_dice_coef: 0.6498 - val_iou_metric: 0.4838 - val_loss: 0.6566
Epoch 24/100
90/90 - 1241s - 14s/step - dice_coef: 0.6554 - iou_metric: 0.4875 - loss: 0.6475 - val_dice_coef: 0.6481 - val_iou_metric: 0.4820 - val_loss: 0.6484
Epoch 25/100
90/90 - 1223s - 14s/step - dice_coef: 0.6583 - iou_metric: 0.4907 - loss: 0.6401 - val_dice_coef: 0.6421 - val_iou_metric: 0.4754 - val_loss: 0.6466
Epoch 26/100
90/90 - 1250s - 14s/step - dice_coef: 0.6618 - iou_metric: 0.4946 - loss: 0.6339 - val_dice_coef: 0.6441 - val_iou_metric: 0.4776 - val_loss: 0.6374
Epoch 27/100
90/90 - 1238s - 14s/step - dice_coef: 0.6634 - iou_metric: 0.4964 - loss: 0.6308 - val_dice_coef: 0.6496 - val_iou_metric: 0.4836 - val_loss: 0.6332
Epoch 28/100
90/90 - 1230s - 14s/step - dice_coef: 0.6658 - iou_metric: 0.4991 - loss: 0.6250 - val_dice_coef: 0.6554 - val_iou_metric: 0.4901 - val_loss: 0.6297
Epoch 29/100
90/90 - 1262s - 14s/step - dice_coef: 0.6670 - iou_metric: 0.5004 - loss: 0.6230 - val_dice_coef: 0.6482 - val_iou_metric: 0.4820 - val_loss: 0.6337
Epoch 30/100
90/90 - 1220s - 14s/step - dice_coef: 0.6694 - iou_metric: 0.5032 - loss: 0.6194 - val_dice_coef: 0.6612 - val_iou_metric: 0.4964 - val_loss: 0.6246
Epoch 31/100
90/90 - 1208s - 13s/step - dice_coef: 0.6708 - iou_metric: 0.5047 - loss: 0.6165 - val_dice_coef: 0.6558 - val_iou_metric: 0.4905 - val_loss: 0.6256
Epoch 32/100
90/90 - 1200s - 13s/step - dice_coef: 0.6713 - iou_metric: 0.5052 - loss: 0.6139 - val_dice_coef: 0.6421 - val_iou_metric: 0.4753 - val_loss: 0.6666
Epoch 33/100
90/90 - 1217s - 14s/step - dice_coef: 0.6646 - iou_metric: 0.4977 - loss: 0.6305 - val_dice_coef: 0.6646 - val_iou_metric: 0.5002 - val_loss: 0.6249
Epoch 34/100
90/90 - 1160s - 13s/step - dice_coef: 0.6715 - iou_metric: 0.5055 - loss: 0.6146 - val_dice_coef: 0.6565 - val_iou_metric: 0.4912 - val_loss: 0.6215
Epoch 35/100
90/90 - 1137s - 13s/step - dice_coef: 0.6731 - iou_metric: 0.5073 - loss: 0.6116 - val_dice_coef: 0.6544 - val_iou_metric: 0.4889 - val_loss: 0.6191
Epoch 36/100
90/90 - 1123s - 12s/step - dice_coef: 0.6744 - iou_metric: 0.5088 - loss: 0.6095 - val_dice_coef: 0.6612 - val_iou_metric: 0.4965 - val_loss: 0.6168
Epoch 37/100
90/90 - 1112s - 12s/step - dice_coef: 0.6743 - iou_metric: 0.5087 - loss: 0.6081 - val_dice_coef: 0.6669 - val_iou_metric: 0.5028 - val_loss: 0.6146
Epoch 38/100
90/90 - 1114s - 12s/step - dice_coef: 0.6754 - iou_metric: 0.5100 - loss: 0.6071 - val_dice_coef: 0.6556 - val_iou_metric: 0.4902 - val_loss: 0.6168
Epoch 39/100
90/90 - 1101s - 12s/step - dice_coef: 0.6762 - iou_metric: 0.5108 - loss: 0.6054 - val_dice_coef: 0.6575 - val_iou_metric: 0.4923 - val_loss: 0.6128
Epoch 40/100
90/90 - 1097s - 12s/step - dice_coef: 0.6769 - iou_metric: 0.5116 - loss: 0.6039 - val_dice_coef: 0.6670 - val_iou_metric: 0.5030 - val_loss: 0.6121
Epoch 41/100
90/90 - 1094s - 12s/step - dice_coef: 0.6775 - iou_metric: 0.5124 - loss: 0.6027 - val_dice_coef: 0.6651 - val_iou_metric: 0.5008 - val_loss: 0.6104
Epoch 42/100
90/90 - 1088s - 12s/step - dice_coef: 0.6770 - iou_metric: 0.5118 - loss: 0.6027 - val_dice_coef: 0.6641 - val_iou_metric: 0.4997 - val_loss: 0.6091
Epoch 43/100
90/90 - 1091s - 12s/step - dice_coef: 0.6783 - iou_metric: 0.5132 - loss: 0.6005 - val_dice_coef: 0.6592 - val_iou_metric: 0.4943 - val_loss: 0.6176
Epoch 44/100
90/90 - 1102s - 12s/step - dice_coef: 0.6788 - iou_metric: 0.5138 - loss: 0.5996 - val_dice_coef: 0.6650 - val_iou_metric: 0.5008 - val_loss: 0.6066
Epoch 45/100
90/90 - 1110s - 12s/step - dice_coef: 0.6792 - iou_metric: 0.5143 - loss: 0.5984 - val_dice_coef: 0.6664 - val_iou_metric: 0.5024 - val_loss: 0.6062
Epoch 46/100
90/90 - 1098s - 12s/step - dice_coef: 0.6796 - iou_metric: 0.5148 - loss: 0.5975 - val_dice_coef: 0.6594 - val_iou_metric: 0.4945 - val_loss: 0.6151
Epoch 47/100
90/90 - 1102s - 12s/step - dice_coef: 0.6800 - iou_metric: 0.5152 - loss: 0.5969 - val_dice_coef: 0.6733 - val_iou_metric: 0.5101 - val_loss: 0.6124
Epoch 48/100
90/90 - 1083s - 12s/step - dice_coef: 0.6804 - iou_metric: 0.5157 - loss: 0.5957 - val_dice_coef: 0.6667 - val_iou_metric: 0.5026 - val_loss: 0.6075
Epoch 49/100
90/90 - 1096s - 12s/step - dice_coef: 0.6812 - iou_metric: 0.5166 - loss: 0.5945 - val_dice_coef: 0.6556 - val_iou_metric: 0.4903 - val_loss: 0.6133
Epoch 50/100
90/90 - 1157s - 13s/step - dice_coef: 0.6810 - iou_metric: 0.5163 - loss: 0.5947 - val_dice_coef: 0.6657 - val_iou_metric: 0.5016 - val_loss: 0.6033
Epoch 51/100
90/90 - 1212s - 13s/step - dice_coef: 0.6817 - iou_metric: 0.5171 - loss: 0.5928 - val_dice_coef: 0.6677 - val_iou_metric: 0.5038 - val_loss: 0.6037
Epoch 52/100
90/90 - 1223s - 14s/step - dice_coef: 0.6819 - iou_metric: 0.5174 - loss: 0.5930 - val_dice_coef: 0.6595 - val_iou_metric: 0.4946 - val_loss: 0.6216
Epoch 53/100
90/90 - 1243s - 14s/step - dice_coef: 0.6747 - iou_metric: 0.5093 - loss: 0.6093 - val_dice_coef: 0.6599 - val_iou_metric: 0.4950 - val_loss: 0.6146
Epoch 54/100
90/90 - 1183s - 13s/step - dice_coef: 0.6802 - iou_metric: 0.5155 - loss: 0.5950 - val_dice_coef: 0.6674 - val_iou_metric: 0.5034 - val_loss: 0.6034
Epoch 55/100
90/90 - 1178s - 13s/step - dice_coef: 0.6812 - iou_metric: 0.5165 - loss: 0.5951 - val_dice_coef: 0.6687 - val_iou_metric: 0.5049 - val_loss: 0.6114
Epoch 56/100
90/90 - 1206s - 13s/step - dice_coef: 0.6698 - iou_metric: 0.5037 - loss: 0.6206 - val_dice_coef: 0.6639 - val_iou_metric: 0.4994 - val_loss: 0.6170
Epoch 57/100
90/90 - 1174s - 13s/step - dice_coef: 0.6766 - iou_metric: 0.5114 - loss: 0.6033 - val_dice_coef: 0.6714 - val_iou_metric: 0.5080 - val_loss: 0.6135
Epoch 58/100
90/90 - 1182s - 13s/step - dice_coef: 0.6779 - iou_metric: 0.5128 - loss: 0.6028 - val_dice_coef: 0.6701 - val_iou_metric: 0.5065 - val_loss: 0.6059
Epoch 59/100
90/90 - 3220s - 36s/step - dice_coef: 0.6810 - iou_metric: 0.5164 - loss: 0.5953 - val_dice_coef: 0.6737 - val_iou_metric: 0.5106 - val_loss: 0.6031
Epoch 60/100
90/90 - 1158s - 13s/step - dice_coef: 0.6825 - iou_metric: 0.5181 - loss: 0.5927 - val_dice_coef: 0.6651 - val_iou_metric: 0.5008 - val_loss: 0.6056
Epoch 61/100
90/90 - 1173s - 13s/step - dice_coef: 0.6827 - iou_metric: 0.5183 - loss: 0.5917 - val_dice_coef: 0.6614 - val_iou_metric: 0.4968 - val_loss: 0.6128
Epoch 62/100
90/90 - 1162s - 13s/step - dice_coef: 0.6817 - iou_metric: 0.5172 - loss: 0.5934 - val_dice_coef: 0.6720 - val_iou_metric: 0.5087 - val_loss: 0.6011
Epoch 63/100
90/90 - 1096s - 12s/step - dice_coef: 0.6836 - iou_metric: 0.5193 - loss: 0.5901 - val_dice_coef: 0.6623 - val_iou_metric: 0.4977 - val_loss: 0.6035
Epoch 64/100
90/90 - 1227s - 14s/step - dice_coef: 0.6840 - iou_metric: 0.5198 - loss: 0.5898 - val_dice_coef: 0.6667 - val_iou_metric: 0.5027 - val_loss: 0.6001
Epoch 65/100
job dir: /Users/dpeleg/PycharmProjects/mae
['liver_0' 'liver_1' 'liver_2' 'liver_3' 'liver_4' 'liver_5' 'liver_6'
 'liver_7' 'liver_8' 'liver_9' 'liver_10' 'liver_11' 'liver_12' 'liver_13'
 'liver_14' 'liver_15' 'liver_16' 'liver_17' 'liver_18' 'liver_19'
 'liver_20' 'liver_21' 'liver_22' 'liver_23' 'liver_24' 'liver_25'
 'liver_26' 'liver_27' 'liver_28' 'liver_29' 'liver_30' 'liver_31'
 'liver_32' 'liver_33' 'liver_34' 'liver_35' 'liver_36' 'liver_37'
 'liver_38' 'liver_39' 'liver_40' 'liver_41' 'liver_42' 'liver_43'
 'liver_44' 'liver_45' 'liver_46' 'liver_47' 'liver_48' 'liver_49'
 'liver_50' 'liver_51' 'liver_52' 'liver_53' 'liver_54' 'liver_55'
 'liver_56' 'liver_57' 'liver_58' 'liver_59' 'liver_60' 'liver_61'
 'liver_62' 'liver_63' 'liver_64' 'liver_65' 'liver_66' 'liver_67'
 'liver_68' 'liver_69' 'liver_70' 'liver_71' 'liver_72' 'liver_73'
 'liver_74' 'liver_75' 'liver_76' 'liver_77' 'liver_78' 'liver_79'
 'liver_80' 'liver_81' 'liver_82' 'liver_83' 'liver_84' 'liver_85'
 'liver_86' 'liver_87' 'liver_88' 'liver_89' 'liver_90' 'liver_91'
 'liver_92' 'liver_93' 'liver_94' 'liver_95' 'liver_96' 'liver_97'
 'liver_98' 'liver_99' 'liver_100' 'liver_101' 'liver_102' 'liver_103'
 'liver_104' 'liver_105' 'liver_106' 'liver_107' 'liver_108' 'liver_109'
 'liver_110' 'liver_111' 'liver_112' 'liver_113' 'liver_114' 'liver_115'
 'liver_116' 'liver_117' 'liver_118' 'liver_119' 'liver_120' 'liver_121'
 'liver_122' 'liver_123' 'liver_124' 'liver_125' 'liver_126' 'liver_127'
 'liver_128' 'liver_129' 'liver_130']
Len (X, Y, Patients): 131 131 131
Sample Patient Shapes (liver_2): X[2] Y[2]: (139, 256, 256, 1) (139, 256, 256, 1)
Sample 0: liver_0.nii.gz
Sample 1: liver_1.nii.gz
train idx:  [31, 45, 56, 122, 55, 4, 80, 27, 64, 81, 115, 93, 105, 97, 18, 19] Length:  16 <class 'list'>
test idx:  [11, 36, 127, 40, 95, 10] Length:  6 <class 'list'>
val idx:  [69, 26, 84, 70, 100] Length:  5 <class 'list'>
###### Summary of the dataset
Number of patients:  131
Train X shape: (2465, 256, 256, 1)
Train Y shape: (2465, 256, 256, 1)
Val X shape: (932, 256, 256, 1)
Val Y shape: (932, 256, 256, 1)
Test X shape: (1017, 256, 256, 1)
Test Y shape: (1017, 256, 256, 1)
###### End Summary ##########
Sample 0: liver_0.nii.gz
Sample 1: liver_1.nii.gz
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 256, 256,  │          0 │ -                 │
│ (InputLayer)        │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 256, 256,  │        320 │ input_layer[0][0] │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 128, 128,  │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 128, 128,  │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 64, 64,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 64, 64,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 64, 64,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 128, 128,  │          0 │ conv2d_5[0][0]    │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 128, 128,  │          0 │ up_sampling2d[0]… │
│ (Concatenate)       │ 192)              │            │ conv2d_3[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 128, 128,  │    110,656 │ concatenate[0][0] │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_6[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 256, 256,  │          0 │ conv2d_7[0][0]    │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 256, 256,  │          0 │ up_sampling2d_1[… │
│ (Concatenate)       │ 96)               │            │ conv2d_1[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 256, 256,  │     27,680 │ concatenate_1[0]… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d_8[0][0]    │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 256, 256,  │         33 │ conv2d_9[0][0]    │
│                     │ 1)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 470,977 (1.80 MB)
 Trainable params: 470,977 (1.80 MB)
 Non-trainable params: 0 (0.00 B)
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 256, 256,  │          0 │ -                 │
│ (InputLayer)        │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 256, 256,  │        320 │ input_layer[0][0] │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 128, 128,  │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 128, 128,  │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 64, 64,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 64, 64,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 64, 64,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 128, 128,  │          0 │ conv2d_5[0][0]    │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 128, 128,  │          0 │ up_sampling2d[0]… │
│ (Concatenate)       │ 192)              │            │ conv2d_3[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 128, 128,  │    110,656 │ concatenate[0][0] │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_6[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 256, 256,  │          0 │ conv2d_7[0][0]    │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 256, 256,  │          0 │ up_sampling2d_1[… │
│ (Concatenate)       │ 96)               │            │ conv2d_1[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 256, 256,  │     27,680 │ concatenate_1[0]… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d_8[0][0]    │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 256, 256,  │         33 │ conv2d_9[0][0]    │
│                     │ 1)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 1,412,933 (5.39 MB)
 Trainable params: 470,977 (1.80 MB)
 Non-trainable params: 0 (0.00 B)
 Optimizer params: 941,956 (3.59 MB)
Epoch 1/20
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1753031009.767525 13547826 service.cc:152] XLA service 0x6000000d8b00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1753031009.767563 13547826 service.cc:160]   StreamExecutor device (0): Host, Default Version
2025-07-20 20:03:29.788538: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1753031010.079115 13547826 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
20/20 - 587s - 29s/step - dice_coef: 0.4144 - iou_metric: 0.2773 - loss: 0.8298 - val_dice_coef: 0.6047 - val_iou_metric: 0.4448 - val_loss: 0.5602
Epoch 2/20
20/20 - 586s - 29s/step - dice_coef: 0.6670 - iou_metric: 0.5022 - loss: 0.4659 - val_dice_coef: 0.7166 - val_iou_metric: 0.5687 - val_loss: 0.3560
Epoch 3/20
20/20 - 582s - 29s/step - dice_coef: 0.7524 - iou_metric: 0.6038 - loss: 0.3515 - val_dice_coef: 0.7362 - val_iou_metric: 0.5934 - val_loss: 0.3384
Epoch 4/20
20/20 - 571s - 29s/step - dice_coef: 0.7647 - iou_metric: 0.6195 - loss: 0.3234 - val_dice_coef: 0.7831 - val_iou_metric: 0.6535 - val_loss: 0.2758
Epoch 5/20
20/20 - 576s - 29s/step - dice_coef: 0.8094 - iou_metric: 0.6800 - loss: 0.2680 - val_dice_coef: 0.7509 - val_iou_metric: 0.6088 - val_loss: 0.3162
Epoch 6/20
20/20 - 571s - 29s/step - dice_coef: 0.8346 - iou_metric: 0.7163 - loss: 0.2292 - val_dice_coef: 0.8221 - val_iou_metric: 0.7089 - val_loss: 0.2298
Epoch 7/20
20/20 - 575s - 29s/step - dice_coef: 0.8502 - iou_metric: 0.7398 - loss: 0.2086 - val_dice_coef: 0.8377 - val_iou_metric: 0.7305 - val_loss: 0.2059
Epoch 8/20
20/20 - 570s - 29s/step - dice_coef: 0.8766 - iou_metric: 0.7804 - loss: 0.1704 - val_dice_coef: 0.8091 - val_iou_metric: 0.6933 - val_loss: 0.2737
Epoch 9/20
20/20 - 573s - 29s/step - dice_coef: 0.8371 - iou_metric: 0.7208 - loss: 0.2316 - val_dice_coef: 0.8307 - val_iou_metric: 0.7207 - val_loss: 0.2143
Epoch 10/20
20/20 - 569s - 28s/step - dice_coef: 0.8769 - iou_metric: 0.7810 - loss: 0.1726 - val_dice_coef: 0.8254 - val_iou_metric: 0.7122 - val_loss: 0.2207
Epoch 11/20
20/20 - 573s - 29s/step - dice_coef: 0.8913 - iou_metric: 0.8041 - loss: 0.1528 - val_dice_coef: 0.8548 - val_iou_metric: 0.7558 - val_loss: 0.1843
Epoch 12/20
20/20 - 579s - 29s/step - dice_coef: 0.9037 - iou_metric: 0.8245 - loss: 0.1343 - val_dice_coef: 0.8425 - val_iou_metric: 0.7395 - val_loss: 0.2118
Epoch 13/20
20/20 - 574s - 29s/step - dice_coef: 0.8902 - iou_metric: 0.8026 - loss: 0.1552 - val_dice_coef: 0.8534 - val_iou_metric: 0.7535 - val_loss: 0.1901
Epoch 14/20
20/20 - 575s - 29s/step - dice_coef: 0.9144 - iou_metric: 0.8423 - loss: 0.1212 - val_dice_coef: 0.8551 - val_iou_metric: 0.7545 - val_loss: 0.1941
Epoch 15/20
20/20 - 574s - 29s/step - dice_coef: 0.9152 - iou_metric: 0.8438 - loss: 0.1188 - val_dice_coef: 0.8661 - val_iou_metric: 0.7738 - val_loss: 0.1704
Epoch 16/20
20/20 - 577s - 29s/step - dice_coef: 0.9255 - iou_metric: 0.8614 - loss: 0.1053 - val_dice_coef: 0.8733 - val_iou_metric: 0.7837 - val_loss: 0.1628
Epoch 17/20
20/20 - 576s - 29s/step - dice_coef: 0.9222 - iou_metric: 0.8557 - loss: 0.1098 - val_dice_coef: 0.8507 - val_iou_metric: 0.7475 - val_loss: 0.2028
Epoch 18/20
20/20 - 573s - 29s/step - dice_coef: 0.9286 - iou_metric: 0.8668 - loss: 0.1013 - val_dice_coef: 0.8737 - val_iou_metric: 0.7855 - val_loss: 0.1639
Epoch 19/20
20/20 - 571s - 29s/step - dice_coef: 0.9360 - iou_metric: 0.8798 - loss: 0.0910 - val_dice_coef: 0.8760 - val_iou_metric: 0.7883 - val_loss: 0.1607
Epoch 20/20
20/20 - 572s - 29s/step - dice_coef: 0.9409 - iou_metric: 0.8884 - loss: 0.0836 - val_dice_coef: 0.8722 - val_iou_metric: 0.7830 - val_loss: 0.1680
[1m 1/30[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m43s[0m 1s/step - dice_coef: 0.9510 - iou_metric: 0.9067 - loss: 0.0537[1m 2/30[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m38s[0m 1s/step - dice_coef: 0.9490 - iou_metric: 0.9030 - loss: 0.0626[1m 3/30[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m38s[0m 1s/step - dice_coef: 0.9476 - iou_metric: 0.9005 - loss: 0.0684[1m 4/30[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m36s[0m 1s/step - dice_coef: 0.9470 - iou_metric: 0.8993 - loss: 0.0699[1m 5/30[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m35s[0m 1s/step - dice_coef: 0.9471 - iou_metric: 0.8995 - loss: 0.0697[1m 6/30[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m33s[0m 1s/step - dice_coef: 0.9475 - iou_metric: 0.9002 - loss: 0.0691[1m 7/30[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m32s[0m 1s/step - dice_coef: 0.9478 - iou_metric: 0.9008 - loss: 0.0688[1m 8/30[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m31s[0m 1s/step - dice_coef: 0.9483 - iou_metric: 0.9018 - loss: 0.0683[1m 9/30[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m29s[0m 1s/step - dice_coef: 0.9485 - iou_metric: 0.9021 - loss: 0.0681[1m10/30[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m28s[0m 1s/step - dice_coef: 0.9415 - iou_metric: 0.8947 - loss: 0.0752[1m11/30[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m26s[0m 1s/step - dice_coef: 0.9342 - iou_metric: 0.8861 - loss: 0.0830[1m12/30[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m25s[0m 1s/step - dice_coef: 0.9285 - iou_metric: 0.8791 - loss: 0.0894[1m13/30[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m24s[0m 1s/step - dice_coef: 0.9239 - iou_metric: 0.8735 - loss: 0.0947[1m14/30[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m22s[0m 1s/step - dice_coef: 0.9200 - iou_metric: 0.8685 - loss: 0.0998[1m15/30[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m21s[0m 1s/step - dice_coef: 0.9169 - iou_metric: 0.8645 - loss: 0.1044[1m16/30[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m19s[0m 1s/step - dice_coef: 0.9143 - iou_metric: 0.8610 - loss: 0.1084[1m17/30[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m18s[0m 1s/step - dice_coef: 0.9110 - iou_metric: 0.8566 - loss: 0.1135[1m18/30[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m17s[0m 1s/step - dice_coef: 0.9080 - iou_metric: 0.8524 - loss: 0.1180[1m19/30[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m15s[0m 1s/step - dice_coef: 0.9055 - iou_metric: 0.8488 - loss: 0.1220[1m20/30[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m14s[0m 1s/step - dice_coef: 0.9033 - iou_metric: 0.8458 - loss: 0.1256[1m21/30[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m12s[0m 1s/step - dice_coef: 0.9012 - iou_metric: 0.8427 - loss: 0.1289[1m22/30[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m11s[0m 1s/step - dice_coef: 0.8991 - iou_metric: 0.8396 - loss: 0.1320[1m23/30[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m9s[0m 1s/step - dice_coef: 0.8973 - iou_metric: 0.8368 - loss: 0.1348 [1m24/30[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m8s[0m 1s/step - dice_coef: 0.8957 - iou_metric: 0.8344 - loss: 0.1373[1m25/30[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m7s[0m 1s/step - dice_coef: 0.8944 - iou_metric: 0.8322 - loss: 0.1396[1m26/30[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m5s[0m 1s/step - dice_coef: 0.8932 - iou_metric: 0.8304 - loss: 0.1416[1m27/30[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m4s[0m 1s/step - dice_coef: 0.8922 - iou_metric: 0.8288 - loss: 0.1434[1m28/30[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m2s[0m 1s/step - dice_coef: 0.8914 - iou_metric: 0.8275 - loss: 0.1450[1m29/30[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m1s[0m 1s/step - dice_coef: 0.8904 - iou_metric: 0.8259 - loss: 0.1468[1m30/30[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1s/step - dice_coef: 0.8888 - iou_metric: 0.8237 - loss: 0.1486[1m30/30[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m42s[0m 1s/step - dice_coef: 0.8873 - iou_metric: 0.8217 - loss: 0.1502
Validation Dice and IoU: [0.19994431734085083, 0.8415665030479431, 0.7602561116218567]
Model saved to UNet_Model/saved_models/unet_finetune_ct_liver_131_20.keras
Training history saved to UNet_Model/saved_models/unet_finetune_ct_history_131_20.json
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 256, 256,  │          0 │ -                 │
│ (InputLayer)        │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 256, 256,  │        320 │ input_layer[0][0] │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 128, 128,  │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 128, 128,  │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 64, 64,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 64, 64,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 64, 64,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 128, 128,  │          0 │ conv2d_5[0][0]    │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 128, 128,  │          0 │ up_sampling2d[0]… │
│ (Concatenate)       │ 192)              │            │ conv2d_3[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 128, 128,  │    110,656 │ concatenate[0][0] │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_6[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 256, 256,  │          0 │ conv2d_7[0][0]    │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 256, 256,  │          0 │ up_sampling2d_1[… │
│ (Concatenate)       │ 96)               │            │ conv2d_1[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 256, 256,  │     27,680 │ concatenate_1[0]… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d_8[0][0]    │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 256, 256,  │         33 │ conv2d_9[0][0]    │
│                     │ 1)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 1,412,933 (5.39 MB)
 Trainable params: 470,977 (1.80 MB)
 Non-trainable params: 0 (0.00 B)
 Optimizer params: 941,956 (3.59 MB)
total patients for testing: 6
X Test All Shape:  6 Y Test All Shape:  6 patient_ids_test:  6
test_idx:  [11, 36, 127, 40, 95, 10]
patient_ids_test:  ['liver_11', 'liver_36', 'liver_127', 'liver_40', 'liver_95', 'liver_10']

####### Enter
<class 'list'>
selected_ids:  ['liver_11', 'liver_36', 'liver_127', 'liver_40', 'liver_95', 'liver_10']
selected_X.shape:  (1017, 256, 256, 1)
Len slice_patient_ids:  1017
####### Exit

Evaluating...

Mean Dice score per slice: 0.8626
Mean IoU  score per slice: 0.7913
Mean Dice score per patient: 0.8607
Mean IoU  score per patient: 0.7871
    12664.20 real     60202.53 user     15085.05 sys
