job dir: /Users/dpeleg/PycharmProjects/mae
['liver_0' 'liver_1' 'liver_2' 'liver_3' 'liver_4' 'liver_5' 'liver_6'
 'liver_7' 'liver_8' 'liver_9' 'liver_10' 'liver_11' 'liver_12' 'liver_13'
 'liver_14' 'liver_15' 'liver_16' 'liver_17' 'liver_18' 'liver_19'
 'liver_20' 'liver_21' 'liver_22' 'liver_23' 'liver_24' 'liver_25'
 'liver_26' 'liver_27' 'liver_28' 'liver_29' 'liver_30' 'liver_31'
 'liver_32' 'liver_33' 'liver_34' 'liver_35' 'liver_36' 'liver_37'
 'liver_38' 'liver_39' 'liver_40' 'liver_41' 'liver_42' 'liver_43'
 'liver_44' 'liver_45' 'liver_46' 'liver_47' 'liver_48' 'liver_49'
 'liver_50' 'liver_51' 'liver_52' 'liver_53' 'liver_54' 'liver_55'
 'liver_56' 'liver_57' 'liver_58' 'liver_59' 'liver_60' 'liver_61'
 'liver_62' 'liver_63' 'liver_64' 'liver_65' 'liver_66' 'liver_67'
 'liver_68' 'liver_69' 'liver_70' 'liver_71' 'liver_72' 'liver_73'
 'liver_74' 'liver_75' 'liver_76' 'liver_77' 'liver_78' 'liver_79'
 'liver_80' 'liver_81' 'liver_82' 'liver_83' 'liver_84' 'liver_85'
 'liver_86' 'liver_87' 'liver_88' 'liver_89' 'liver_90' 'liver_91'
 'liver_92' 'liver_93' 'liver_94' 'liver_95' 'liver_96' 'liver_97'
 'liver_98' 'liver_99' 'liver_100' 'liver_101' 'liver_102' 'liver_103'
 'liver_104' 'liver_105' 'liver_106' 'liver_107' 'liver_108' 'liver_109'
 'liver_110' 'liver_111' 'liver_112' 'liver_113' 'liver_114' 'liver_115'
 'liver_116' 'liver_117' 'liver_118' 'liver_119' 'liver_120' 'liver_121'
 'liver_122' 'liver_123' 'liver_124' 'liver_125' 'liver_126' 'liver_127'
 'liver_128' 'liver_129' 'liver_130']
Len (X, Y, Patients): 131 131 131
Sample Patient Shapes (liver_2): X[2] Y[2]: (139, 256, 256, 1) (139, 256, 256, 1)
Sample 0: liver_0.nii.gz
Sample 1: liver_1.nii.gz
train idx:  [31, 45, 56, 122, 55, 4, 80, 27, 64, 81, 115, 93, 105, 97, 18, 19] Length:  16 <class 'list'>
test idx:  [11, 36, 127, 40, 95, 10] Length:  6 <class 'list'>
val idx:  [69, 26, 84, 70, 100] Length:  5 <class 'list'>
###### Summary of the dataset
Number of patients:  131
Train X shape: (2465, 256, 256, 1)
Train Y shape: (2465, 256, 256, 1)
Val X shape: (932, 256, 256, 1)
Val Y shape: (932, 256, 256, 1)
Test X shape: (1017, 256, 256, 1)
Test Y shape: (1017, 256, 256, 1)
###### End Summary ##########
Sample 0: liver_0.nii.gz
Sample 1: liver_1.nii.gz
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 256, 256,  │          0 │ -                 │
│ (InputLayer)        │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 256, 256,  │        320 │ input_layer[0][0] │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 128, 128,  │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 128, 128,  │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 64, 64,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 64, 64,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 64, 64,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 128, 128,  │          0 │ conv2d_5[0][0]    │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 128, 128,  │          0 │ up_sampling2d[0]… │
│ (Concatenate)       │ 192)              │            │ conv2d_3[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 128, 128,  │    110,656 │ concatenate[0][0] │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_6[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 256, 256,  │          0 │ conv2d_7[0][0]    │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 256, 256,  │          0 │ up_sampling2d_1[… │
│ (Concatenate)       │ 96)               │            │ conv2d_1[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 256, 256,  │     27,680 │ concatenate_1[0]… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d_8[0][0]    │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 256, 256,  │         33 │ conv2d_9[0][0]    │
│                     │ 1)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 470,977 (1.80 MB)
 Trainable params: 470,977 (1.80 MB)
 Non-trainable params: 0 (0.00 B)
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 256, 256,  │          0 │ -                 │
│ (InputLayer)        │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 256, 256,  │        320 │ input_layer[0][0] │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 128, 128,  │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 128, 128,  │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 64, 64,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 64, 64,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 64, 64,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 128, 128,  │          0 │ conv2d_5[0][0]    │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 128, 128,  │          0 │ up_sampling2d[0]… │
│ (Concatenate)       │ 192)              │            │ conv2d_3[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 128, 128,  │    110,656 │ concatenate[0][0] │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_6[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 256, 256,  │          0 │ conv2d_7[0][0]    │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 256, 256,  │          0 │ up_sampling2d_1[… │
│ (Concatenate)       │ 96)               │            │ conv2d_1[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 256, 256,  │     27,680 │ concatenate_1[0]… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d_8[0][0]    │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 256, 256,  │         33 │ conv2d_9[0][0]    │
│                     │ 1)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 1,412,933 (5.39 MB)
 Trainable params: 470,977 (1.80 MB)
 Non-trainable params: 0 (0.00 B)
 Optimizer params: 941,956 (3.59 MB)
Epoch 1/20
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1753031009.767525 13547826 service.cc:152] XLA service 0x6000000d8b00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1753031009.767563 13547826 service.cc:160]   StreamExecutor device (0): Host, Default Version
2025-07-20 20:03:29.788538: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1753031010.079115 13547826 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
20/20 - 587s - 29s/step - dice_coef: 0.4144 - iou_metric: 0.2773 - loss: 0.8298 - val_dice_coef: 0.6047 - val_iou_metric: 0.4448 - val_loss: 0.5602
Epoch 2/20
20/20 - 586s - 29s/step - dice_coef: 0.6670 - iou_metric: 0.5022 - loss: 0.4659 - val_dice_coef: 0.7166 - val_iou_metric: 0.5687 - val_loss: 0.3560
Epoch 3/20
20/20 - 582s - 29s/step - dice_coef: 0.7524 - iou_metric: 0.6038 - loss: 0.3515 - val_dice_coef: 0.7362 - val_iou_metric: 0.5934 - val_loss: 0.3384
Epoch 4/20
20/20 - 571s - 29s/step - dice_coef: 0.7647 - iou_metric: 0.6195 - loss: 0.3234 - val_dice_coef: 0.7831 - val_iou_metric: 0.6535 - val_loss: 0.2758
Epoch 5/20
20/20 - 576s - 29s/step - dice_coef: 0.8094 - iou_metric: 0.6800 - loss: 0.2680 - val_dice_coef: 0.7509 - val_iou_metric: 0.6088 - val_loss: 0.3162
Epoch 6/20
20/20 - 571s - 29s/step - dice_coef: 0.8346 - iou_metric: 0.7163 - loss: 0.2292 - val_dice_coef: 0.8221 - val_iou_metric: 0.7089 - val_loss: 0.2298
Epoch 7/20
20/20 - 575s - 29s/step - dice_coef: 0.8502 - iou_metric: 0.7398 - loss: 0.2086 - val_dice_coef: 0.8377 - val_iou_metric: 0.7305 - val_loss: 0.2059
Epoch 8/20
20/20 - 570s - 29s/step - dice_coef: 0.8766 - iou_metric: 0.7804 - loss: 0.1704 - val_dice_coef: 0.8091 - val_iou_metric: 0.6933 - val_loss: 0.2737
Epoch 9/20
20/20 - 573s - 29s/step - dice_coef: 0.8371 - iou_metric: 0.7208 - loss: 0.2316 - val_dice_coef: 0.8307 - val_iou_metric: 0.7207 - val_loss: 0.2143
Epoch 10/20
20/20 - 569s - 28s/step - dice_coef: 0.8769 - iou_metric: 0.7810 - loss: 0.1726 - val_dice_coef: 0.8254 - val_iou_metric: 0.7122 - val_loss: 0.2207
Epoch 11/20
20/20 - 573s - 29s/step - dice_coef: 0.8913 - iou_metric: 0.8041 - loss: 0.1528 - val_dice_coef: 0.8548 - val_iou_metric: 0.7558 - val_loss: 0.1843
Epoch 12/20
20/20 - 579s - 29s/step - dice_coef: 0.9037 - iou_metric: 0.8245 - loss: 0.1343 - val_dice_coef: 0.8425 - val_iou_metric: 0.7395 - val_loss: 0.2118
Epoch 13/20
20/20 - 574s - 29s/step - dice_coef: 0.8902 - iou_metric: 0.8026 - loss: 0.1552 - val_dice_coef: 0.8534 - val_iou_metric: 0.7535 - val_loss: 0.1901
Epoch 14/20
20/20 - 575s - 29s/step - dice_coef: 0.9144 - iou_metric: 0.8423 - loss: 0.1212 - val_dice_coef: 0.8551 - val_iou_metric: 0.7545 - val_loss: 0.1941
Epoch 15/20
20/20 - 574s - 29s/step - dice_coef: 0.9152 - iou_metric: 0.8438 - loss: 0.1188 - val_dice_coef: 0.8661 - val_iou_metric: 0.7738 - val_loss: 0.1704
Epoch 16/20
20/20 - 577s - 29s/step - dice_coef: 0.9255 - iou_metric: 0.8614 - loss: 0.1053 - val_dice_coef: 0.8733 - val_iou_metric: 0.7837 - val_loss: 0.1628
Epoch 17/20
20/20 - 576s - 29s/step - dice_coef: 0.9222 - iou_metric: 0.8557 - loss: 0.1098 - val_dice_coef: 0.8507 - val_iou_metric: 0.7475 - val_loss: 0.2028
Epoch 18/20
20/20 - 573s - 29s/step - dice_coef: 0.9286 - iou_metric: 0.8668 - loss: 0.1013 - val_dice_coef: 0.8737 - val_iou_metric: 0.7855 - val_loss: 0.1639
Epoch 19/20
20/20 - 571s - 29s/step - dice_coef: 0.9360 - iou_metric: 0.8798 - loss: 0.0910 - val_dice_coef: 0.8760 - val_iou_metric: 0.7883 - val_loss: 0.1607
Epoch 20/20
20/20 - 572s - 29s/step - dice_coef: 0.9409 - iou_metric: 0.8884 - loss: 0.0836 - val_dice_coef: 0.8722 - val_iou_metric: 0.7830 - val_loss: 0.1680
[1m 1/30[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m43s[0m 1s/step - dice_coef: 0.9510 - iou_metric: 0.9067 - loss: 0.0537[1m 2/30[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m38s[0m 1s/step - dice_coef: 0.9490 - iou_metric: 0.9030 - loss: 0.0626[1m 3/30[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m38s[0m 1s/step - dice_coef: 0.9476 - iou_metric: 0.9005 - loss: 0.0684[1m 4/30[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m36s[0m 1s/step - dice_coef: 0.9470 - iou_metric: 0.8993 - loss: 0.0699[1m 5/30[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m35s[0m 1s/step - dice_coef: 0.9471 - iou_metric: 0.8995 - loss: 0.0697[1m 6/30[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m33s[0m 1s/step - dice_coef: 0.9475 - iou_metric: 0.9002 - loss: 0.0691[1m 7/30[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m32s[0m 1s/step - dice_coef: 0.9478 - iou_metric: 0.9008 - loss: 0.0688[1m 8/30[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m31s[0m 1s/step - dice_coef: 0.9483 - iou_metric: 0.9018 - loss: 0.0683[1m 9/30[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m29s[0m 1s/step - dice_coef: 0.9485 - iou_metric: 0.9021 - loss: 0.0681[1m10/30[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m28s[0m 1s/step - dice_coef: 0.9415 - iou_metric: 0.8947 - loss: 0.0752[1m11/30[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m26s[0m 1s/step - dice_coef: 0.9342 - iou_metric: 0.8861 - loss: 0.0830[1m12/30[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m25s[0m 1s/step - dice_coef: 0.9285 - iou_metric: 0.8791 - loss: 0.0894[1m13/30[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m24s[0m 1s/step - dice_coef: 0.9239 - iou_metric: 0.8735 - loss: 0.0947[1m14/30[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m22s[0m 1s/step - dice_coef: 0.9200 - iou_metric: 0.8685 - loss: 0.0998[1m15/30[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m21s[0m 1s/step - dice_coef: 0.9169 - iou_metric: 0.8645 - loss: 0.1044[1m16/30[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m19s[0m 1s/step - dice_coef: 0.9143 - iou_metric: 0.8610 - loss: 0.1084[1m17/30[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m18s[0m 1s/step - dice_coef: 0.9110 - iou_metric: 0.8566 - loss: 0.1135[1m18/30[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m17s[0m 1s/step - dice_coef: 0.9080 - iou_metric: 0.8524 - loss: 0.1180[1m19/30[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m15s[0m 1s/step - dice_coef: 0.9055 - iou_metric: 0.8488 - loss: 0.1220[1m20/30[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m14s[0m 1s/step - dice_coef: 0.9033 - iou_metric: 0.8458 - loss: 0.1256[1m21/30[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m12s[0m 1s/step - dice_coef: 0.9012 - iou_metric: 0.8427 - loss: 0.1289[1m22/30[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m11s[0m 1s/step - dice_coef: 0.8991 - iou_metric: 0.8396 - loss: 0.1320[1m23/30[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m9s[0m 1s/step - dice_coef: 0.8973 - iou_metric: 0.8368 - loss: 0.1348 [1m24/30[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m8s[0m 1s/step - dice_coef: 0.8957 - iou_metric: 0.8344 - loss: 0.1373[1m25/30[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m7s[0m 1s/step - dice_coef: 0.8944 - iou_metric: 0.8322 - loss: 0.1396[1m26/30[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m5s[0m 1s/step - dice_coef: 0.8932 - iou_metric: 0.8304 - loss: 0.1416[1m27/30[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m4s[0m 1s/step - dice_coef: 0.8922 - iou_metric: 0.8288 - loss: 0.1434[1m28/30[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m2s[0m 1s/step - dice_coef: 0.8914 - iou_metric: 0.8275 - loss: 0.1450[1m29/30[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m1s[0m 1s/step - dice_coef: 0.8904 - iou_metric: 0.8259 - loss: 0.1468[1m30/30[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1s/step - dice_coef: 0.8888 - iou_metric: 0.8237 - loss: 0.1486[1m30/30[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m42s[0m 1s/step - dice_coef: 0.8873 - iou_metric: 0.8217 - loss: 0.1502
Validation Dice and IoU: [0.19994431734085083, 0.8415665030479431, 0.7602561116218567]
Model saved to UNet_Model/saved_models/unet_finetune_ct_liver_131_20.keras
Training history saved to UNet_Model/saved_models/unet_finetune_ct_history_131_20.json
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 256, 256,  │          0 │ -                 │
│ (InputLayer)        │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 256, 256,  │        320 │ input_layer[0][0] │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 128, 128,  │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 128, 128,  │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 64, 64,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 64, 64,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 64, 64,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 128, 128,  │          0 │ conv2d_5[0][0]    │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 128, 128,  │          0 │ up_sampling2d[0]… │
│ (Concatenate)       │ 192)              │            │ conv2d_3[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 128, 128,  │    110,656 │ concatenate[0][0] │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_6[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 256, 256,  │          0 │ conv2d_7[0][0]    │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 256, 256,  │          0 │ up_sampling2d_1[… │
│ (Concatenate)       │ 96)               │            │ conv2d_1[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 256, 256,  │     27,680 │ concatenate_1[0]… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d_8[0][0]    │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 256, 256,  │         33 │ conv2d_9[0][0]    │
│                     │ 1)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 1,412,933 (5.39 MB)
 Trainable params: 470,977 (1.80 MB)
 Non-trainable params: 0 (0.00 B)
 Optimizer params: 941,956 (3.59 MB)
total patients for testing: 6
X Test All Shape:  6 Y Test All Shape:  6 patient_ids_test:  6
test_idx:  [11, 36, 127, 40, 95, 10]
patient_ids_test:  ['liver_11', 'liver_36', 'liver_127', 'liver_40', 'liver_95', 'liver_10']

####### Enter
<class 'list'>
selected_ids:  ['liver_11', 'liver_36', 'liver_127', 'liver_40', 'liver_95', 'liver_10']
selected_X.shape:  (1017, 256, 256, 1)
Len slice_patient_ids:  1017
####### Exit

Evaluating...

Mean Dice score per slice: 0.8626
Mean IoU  score per slice: 0.7913
Mean Dice score per patient: 0.8607
Mean IoU  score per patient: 0.7871
    12664.20 real     60202.53 user     15085.05 sys
