job dir: /Users/dpeleg/PycharmProjects/mae
train idx:  [40, 55, 56, 26, 45, 80, 95, 97, 31, 4, 18, 11, 93, 127, 70, 84] Length:  16 <class 'list'>
test idx:  [69, 19, 105, 10, 27, 100] Length:  6 <class 'list'>
val idx:  [115, 122, 36, 64, 81] Length:  5 <class 'list'>
###### Summary of the dataset
Number of patients:  131
Train X shape: (2597, 256, 256, 1)
Train Y shape: (2597, 256, 256, 1)
Val X shape: (608, 256, 256, 1)
Val Y shape: (608, 256, 256, 1)
Test X shape: (1209, 256, 256, 1)
Test Y shape: (1209, 256, 256, 1)
###### End Summary ##########
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 256, 256,  │          0 │ -                 │
│ (InputLayer)        │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 256, 256,  │        320 │ input_layer[0][0] │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 128, 128,  │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 128, 128,  │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 64, 64,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 64, 64,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 64, 64,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 128, 128,  │          0 │ conv2d_5[0][0]    │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 128, 128,  │          0 │ up_sampling2d[0]… │
│ (Concatenate)       │ 192)              │            │ conv2d_3[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 128, 128,  │    110,656 │ concatenate[0][0] │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_6[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 256, 256,  │          0 │ conv2d_7[0][0]    │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 256, 256,  │          0 │ up_sampling2d_1[… │
│ (Concatenate)       │ 96)               │            │ conv2d_1[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 256, 256,  │     27,680 │ concatenate_1[0]… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d_8[0][0]    │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 256, 256,  │         33 │ conv2d_9[0][0]    │
│                     │ 1)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 470,977 (1.80 MB)
 Trainable params: 470,977 (1.80 MB)
 Non-trainable params: 0 (0.00 B)
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 256, 256,  │          0 │ -                 │
│ (InputLayer)        │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 256, 256,  │        320 │ input_layer[0][0] │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 128, 128,  │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 128, 128,  │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 64, 64,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 64, 64,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 64, 64,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 128, 128,  │          0 │ conv2d_5[0][0]    │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 128, 128,  │          0 │ up_sampling2d[0]… │
│ (Concatenate)       │ 192)              │            │ conv2d_3[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 128, 128,  │    110,656 │ concatenate[0][0] │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_6[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 256, 256,  │          0 │ conv2d_7[0][0]    │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 256, 256,  │          0 │ up_sampling2d_1[… │
│ (Concatenate)       │ 96)               │            │ conv2d_1[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 256, 256,  │     27,680 │ concatenate_1[0]… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d_8[0][0]    │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 256, 256,  │         33 │ conv2d_9[0][0]    │
│                     │ 1)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 1,412,933 (5.39 MB)
 Trainable params: 470,977 (1.80 MB)
 Non-trainable params: 0 (0.00 B)
 Optimizer params: 941,956 (3.59 MB)
Epoch 1/40
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1753083304.176770 14202851 service.cc:152] XLA service 0x600000111200 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
I0000 00:00:1753083304.176801 14202851 service.cc:160]   StreamExecutor device (0): Host, Default Version
2025-07-21 10:35:04.214066: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
I0000 00:00:1753083304.592505 14202851 device_compiler.h:188] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
21/21 - 585s - 28s/step - dice_coef: 0.4649 - iou_metric: 0.3128 - loss: 0.7646 - val_dice_coef: 0.6874 - val_iou_metric: 0.5256 - val_loss: 0.4318
Epoch 2/40
21/21 - 583s - 28s/step - dice_coef: 0.6761 - iou_metric: 0.5122 - loss: 0.4652 - val_dice_coef: 0.7495 - val_iou_metric: 0.6017 - val_loss: 0.3432
Epoch 3/40
21/21 - 566s - 27s/step - dice_coef: 0.7582 - iou_metric: 0.6114 - loss: 0.3402 - val_dice_coef: 0.7778 - val_iou_metric: 0.6406 - val_loss: 0.3168
Epoch 4/40
21/21 - 566s - 27s/step - dice_coef: 0.7741 - iou_metric: 0.6326 - loss: 0.3139 - val_dice_coef: 0.7670 - val_iou_metric: 0.6251 - val_loss: 0.3098
Epoch 5/40
21/21 - 569s - 27s/step - dice_coef: 0.8280 - iou_metric: 0.7067 - loss: 0.2426 - val_dice_coef: 0.8036 - val_iou_metric: 0.6766 - val_loss: 0.2701
Epoch 6/40
21/21 - 569s - 27s/step - dice_coef: 0.8558 - iou_metric: 0.7481 - loss: 0.2018 - val_dice_coef: 0.8208 - val_iou_metric: 0.7009 - val_loss: 0.2574
Epoch 7/40
21/21 - 573s - 27s/step - dice_coef: 0.8597 - iou_metric: 0.7541 - loss: 0.1978 - val_dice_coef: 0.8120 - val_iou_metric: 0.6904 - val_loss: 0.2587
Epoch 8/40
21/21 - 580s - 28s/step - dice_coef: 0.8785 - iou_metric: 0.7836 - loss: 0.1720 - val_dice_coef: 0.8117 - val_iou_metric: 0.6916 - val_loss: 0.2584
Epoch 9/40
21/21 - 582s - 28s/step - dice_coef: 0.8915 - iou_metric: 0.8044 - loss: 0.1538 - val_dice_coef: 0.8261 - val_iou_metric: 0.7119 - val_loss: 0.2387
Epoch 10/40
21/21 - 596s - 28s/step - dice_coef: 0.8992 - iou_metric: 0.8169 - loss: 0.1419 - val_dice_coef: 0.8619 - val_iou_metric: 0.7602 - val_loss: 0.1923
Epoch 11/40
21/21 - 583s - 28s/step - dice_coef: 0.9021 - iou_metric: 0.8218 - loss: 0.1379 - val_dice_coef: 0.8113 - val_iou_metric: 0.6948 - val_loss: 0.2682
Epoch 12/40
21/21 - 588s - 28s/step - dice_coef: 0.9094 - iou_metric: 0.8339 - loss: 0.1271 - val_dice_coef: 0.8592 - val_iou_metric: 0.7586 - val_loss: 0.2011
Epoch 13/40
21/21 - 583s - 28s/step - dice_coef: 0.9166 - iou_metric: 0.8461 - loss: 0.1185 - val_dice_coef: 0.8695 - val_iou_metric: 0.7726 - val_loss: 0.1833
Epoch 14/40
21/21 - 587s - 28s/step - dice_coef: 0.9233 - iou_metric: 0.8575 - loss: 0.1076 - val_dice_coef: 0.8565 - val_iou_metric: 0.7557 - val_loss: 0.2079
Epoch 15/40
21/21 - 588s - 28s/step - dice_coef: 0.9276 - iou_metric: 0.8651 - loss: 0.1019 - val_dice_coef: 0.8656 - val_iou_metric: 0.7680 - val_loss: 0.1938
Epoch 16/40
21/21 - 575s - 27s/step - dice_coef: 0.9332 - iou_metric: 0.8747 - loss: 0.0950 - val_dice_coef: 0.8850 - val_iou_metric: 0.7959 - val_loss: 0.1660
Epoch 17/40
21/21 - 570s - 27s/step - dice_coef: 0.9262 - iou_metric: 0.8626 - loss: 0.1053 - val_dice_coef: 0.8595 - val_iou_metric: 0.7595 - val_loss: 0.2029
Epoch 18/40
21/21 - 570s - 27s/step - dice_coef: 0.9276 - iou_metric: 0.8650 - loss: 0.1027 - val_dice_coef: 0.8476 - val_iou_metric: 0.7427 - val_loss: 0.2182
Epoch 19/40
21/21 - 579s - 28s/step - dice_coef: 0.9325 - iou_metric: 0.8735 - loss: 0.0950 - val_dice_coef: 0.8911 - val_iou_metric: 0.8049 - val_loss: 0.1560
Epoch 20/40
21/21 - 570s - 27s/step - dice_coef: 0.9380 - iou_metric: 0.8833 - loss: 0.0881 - val_dice_coef: 0.8589 - val_iou_metric: 0.7593 - val_loss: 0.2046
Epoch 21/40
21/21 - 574s - 27s/step - dice_coef: 0.9441 - iou_metric: 0.8941 - loss: 0.0793 - val_dice_coef: 0.8682 - val_iou_metric: 0.7724 - val_loss: 0.1936
Epoch 22/40
21/21 - 573s - 27s/step - dice_coef: 0.9465 - iou_metric: 0.8985 - loss: 0.0757 - val_dice_coef: 0.8700 - val_iou_metric: 0.7743 - val_loss: 0.1900
Epoch 23/40
21/21 - 580s - 28s/step - dice_coef: 0.9497 - iou_metric: 0.9043 - loss: 0.0715 - val_dice_coef: 0.8513 - val_iou_metric: 0.7497 - val_loss: 0.2224
Epoch 24/40
21/21 - 571s - 27s/step - dice_coef: 0.9493 - iou_metric: 0.9036 - loss: 0.0720 - val_dice_coef: 0.8823 - val_iou_metric: 0.7921 - val_loss: 0.1755
Epoch 25/40
21/21 - 571s - 27s/step - dice_coef: 0.9521 - iou_metric: 0.9085 - loss: 0.0673 - val_dice_coef: 0.8948 - val_iou_metric: 0.8115 - val_loss: 0.1582
Epoch 26/40
21/21 - 571s - 27s/step - dice_coef: 0.9489 - iou_metric: 0.9029 - loss: 0.0727 - val_dice_coef: 0.8540 - val_iou_metric: 0.7526 - val_loss: 0.2239
Epoch 27/40
21/21 - 579s - 28s/step - dice_coef: 0.9547 - iou_metric: 0.9134 - loss: 0.0645 - val_dice_coef: 0.8852 - val_iou_metric: 0.7963 - val_loss: 0.1726
Epoch 28/40
21/21 - 573s - 27s/step - dice_coef: 0.9562 - iou_metric: 0.9160 - loss: 0.0619 - val_dice_coef: 0.8419 - val_iou_metric: 0.7359 - val_loss: 0.2390
Epoch 29/40
21/21 - 577s - 27s/step - dice_coef: 0.9548 - iou_metric: 0.9136 - loss: 0.0638 - val_dice_coef: 0.8781 - val_iou_metric: 0.7869 - val_loss: 0.1863
Epoch 30/40
21/21 - 571s - 27s/step - dice_coef: 0.9597 - iou_metric: 0.9225 - loss: 0.0575 - val_dice_coef: 0.8781 - val_iou_metric: 0.7874 - val_loss: 0.1880
Epoch 31/40
21/21 - 577s - 27s/step - dice_coef: 0.9601 - iou_metric: 0.9232 - loss: 0.0561 - val_dice_coef: 0.8564 - val_iou_metric: 0.7573 - val_loss: 0.2231
Epoch 32/40
21/21 - 568s - 27s/step - dice_coef: 0.9613 - iou_metric: 0.9255 - loss: 0.0546 - val_dice_coef: 0.8838 - val_iou_metric: 0.7949 - val_loss: 0.1801
Epoch 33/40
21/21 - 573s - 27s/step - dice_coef: 0.9629 - iou_metric: 0.9285 - loss: 0.0523 - val_dice_coef: 0.8906 - val_iou_metric: 0.8054 - val_loss: 0.1713
Epoch 34/40
21/21 - 572s - 27s/step - dice_coef: 0.9641 - iou_metric: 0.9307 - loss: 0.0505 - val_dice_coef: 0.8842 - val_iou_metric: 0.7960 - val_loss: 0.1815
Epoch 35/40
21/21 - 580s - 28s/step - dice_coef: 0.9649 - iou_metric: 0.9321 - loss: 0.0497 - val_dice_coef: 0.8983 - val_iou_metric: 0.8166 - val_loss: 0.1600
Epoch 36/40
21/21 - 571s - 27s/step - dice_coef: 0.9626 - iou_metric: 0.9279 - loss: 0.0531 - val_dice_coef: 0.8794 - val_iou_metric: 0.7894 - val_loss: 0.1892
Epoch 37/40
21/21 - 571s - 27s/step - dice_coef: 0.9661 - iou_metric: 0.9343 - loss: 0.0479 - val_dice_coef: 0.8964 - val_iou_metric: 0.8141 - val_loss: 0.1624
Epoch 38/40
21/21 - 571s - 27s/step - dice_coef: 0.9661 - iou_metric: 0.9344 - loss: 0.0480 - val_dice_coef: 0.8932 - val_iou_metric: 0.8087 - val_loss: 0.1677
Epoch 39/40
21/21 - 583s - 28s/step - dice_coef: 0.9664 - iou_metric: 0.9351 - loss: 0.0475 - val_dice_coef: 0.8979 - val_iou_metric: 0.8166 - val_loss: 0.1615
Epoch 40/40
21/21 - 587s - 28s/step - dice_coef: 0.9675 - iou_metric: 0.9371 - loss: 0.0459 - val_dice_coef: 0.8900 - val_iou_metric: 0.8045 - val_loss: 0.1750
[1m 1/19[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m26s[0m 1s/step - dice_coef: 0.2197 - iou_metric: 0.1234 - loss: 0.8230[1m 2/19[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m23s[0m 1s/step - dice_coef: 0.3383 - iou_metric: 0.2255 - loss: 0.7173[1m 3/19[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m21s[0m 1s/step - dice_coef: 0.4185 - iou_metric: 0.3007 - loss: 0.6520[1m 4/19[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m20s[0m 1s/step - dice_coef: 0.4770 - iou_metric: 0.3586 - loss: 0.6037[1m 5/19[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m19s[0m 1s/step - dice_coef: 0.5195 - iou_metric: 0.4009 - loss: 0.5666[1m 6/19[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m17s[0m 1s/step - dice_coef: 0.5458 - iou_metric: 0.4256 - loss: 0.5423[1m 7/19[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m16s[0m 1s/step - dice_coef: 0.5674 - iou_metric: 0.4461 - loss: 0.5206[1m 8/19[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m15s[0m 1s/step - dice_coef: 0.5870 - iou_metric: 0.4658 - loss: 0.5007[1m 9/19[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m13s[0m 1s/step - dice_coef: 0.6046 - iou_metric: 0.4840 - loss: 0.4827[1m10/19[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m12s[0m 1s/step - dice_coef: 0.6180 - iou_metric: 0.4973 - loss: 0.4686[1m11/19[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m11s[0m 1s/step - dice_coef: 0.6305 - iou_metric: 0.5103 - loss: 0.4551[1m12/19[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m9s[0m 1s/step - dice_coef: 0.6423 - iou_metric: 0.5230 - loss: 0.4421 [1m13/19[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m8s[0m 1s/step - dice_coef: 0.6523 - iou_metric: 0.5337 - loss: 0.4309[1m14/19[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m6s[0m 1s/step - dice_coef: 0.6618 - iou_metric: 0.5440 - loss: 0.4200[1m15/19[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m5s[0m 1s/step - dice_coef: 0.6708 - iou_metric: 0.5540 - loss: 0.4099[1m16/19[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m4s[0m 1s/step - dice_coef: 0.6788 - iou_metric: 0.5629 - loss: 0.4008[1m17/19[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m2s[0m 1s/step - dice_coef: 0.6864 - iou_metric: 0.5713 - loss: 0.3922[1m18/19[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m1s[0m 1s/step - dice_coef: 0.6934 - iou_metric: 0.5793 - loss: 0.3844[1m19/19[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 1s/step - dice_coef: 0.7001 - iou_metric: 0.5869 - loss: 0.3769[1m19/19[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m26s[0m 1s/step - dice_coef: 0.7061 - iou_metric: 0.5938 - loss: 0.3702
Validation Dice and IoU: [0.24232472479343414, 0.8203782439231873, 0.7241107821464539]
Model saved to UNet_Model/saved_models/unet_finetune_ct_liver_131_40.keras
Training history saved to UNet_Model/saved_models/unet_finetune_ct_history_131_40.json
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 256, 256,  │          0 │ -                 │
│ (InputLayer)        │ 1)                │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d (Conv2D)     │ (None, 256, 256,  │        320 │ input_layer[0][0] │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_1 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d[0][0]      │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d       │ (None, 128, 128,  │          0 │ conv2d_1[0][0]    │
│ (MaxPooling2D)      │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_2 (Conv2D)   │ (None, 128, 128,  │     18,496 │ max_pooling2d[0]… │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_3 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_2[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ max_pooling2d_1     │ (None, 64, 64,    │          0 │ conv2d_3[0][0]    │
│ (MaxPooling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_4 (Conv2D)   │ (None, 64, 64,    │     73,856 │ max_pooling2d_1[… │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_5 (Conv2D)   │ (None, 64, 64,    │    147,584 │ conv2d_4[0][0]    │
│                     │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d       │ (None, 128, 128,  │          0 │ conv2d_5[0][0]    │
│ (UpSampling2D)      │ 128)              │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 128, 128,  │          0 │ up_sampling2d[0]… │
│ (Concatenate)       │ 192)              │            │ conv2d_3[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_6 (Conv2D)   │ (None, 128, 128,  │    110,656 │ concatenate[0][0] │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_7 (Conv2D)   │ (None, 128, 128,  │     36,928 │ conv2d_6[0][0]    │
│                     │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ up_sampling2d_1     │ (None, 256, 256,  │          0 │ conv2d_7[0][0]    │
│ (UpSampling2D)      │ 64)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 256, 256,  │          0 │ up_sampling2d_1[… │
│ (Concatenate)       │ 96)               │            │ conv2d_1[0][0]    │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_8 (Conv2D)   │ (None, 256, 256,  │     27,680 │ concatenate_1[0]… │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_9 (Conv2D)   │ (None, 256, 256,  │      9,248 │ conv2d_8[0][0]    │
│                     │ 32)               │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv2d_10 (Conv2D)  │ (None, 256, 256,  │         33 │ conv2d_9[0][0]    │
│                     │ 1)                │            │                   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 1,412,933 (5.39 MB)
 Trainable params: 470,977 (1.80 MB)
 Non-trainable params: 0 (0.00 B)
 Optimizer params: 941,956 (3.59 MB)
total patients for testing: 6
Evaluating...

Mean Dice score per slice: 0.8906
Mean IoU  score per slice: 0.8338
Mean Dice score per patient: 0.8957
Mean IoU  score per patient: 0.8401
    23201.42 real    120545.60 user     30374.71 sys
